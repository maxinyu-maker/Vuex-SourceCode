{"remainingRequest":"/Users/maxinyu/Desktop/Vuex-SourceCode/node_modules/babel-loader/lib/index.js!/Users/maxinyu/Desktop/Vuex-SourceCode/src/vuex/store.js","dependencies":[{"path":"/Users/maxinyu/Desktop/Vuex-SourceCode/src/vuex/store.js","mtime":1639130895299},{"path":"/Users/maxinyu/Desktop/Vuex-SourceCode/babel.config.js","mtime":1639106845094},{"path":"/Users/maxinyu/Desktop/Vuex-SourceCode/node_modules/cache-loader/dist/cjs.js","mtime":1638500772549},{"path":"/Users/maxinyu/Desktop/Vuex-SourceCode/node_modules/babel-loader/lib/index.js","mtime":1638500772541}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvbWF4aW55dS9EZXNrdG9wL1Z1ZXgtU291cmNlQ29kZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2suanMiOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy9tYXhpbnl1L0Rlc2t0b3AvVnVleC1Tb3VyY2VDb2RlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcy5qcyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL1VzZXJzL21heGlueXUvRGVza3RvcC9WdWV4LVNvdXJjZUNvZGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0eS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5jcmVhdGUuanMiOwppbXBvcnQgeyByZWFjdGl2ZSB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IGZvckVhY2hWYWx1ZSB9IGZyb20gJy4vdXRpbHMnOwppbXBvcnQgeyBzdG9yZUtleSB9IGZyb20gJy4vaW5qZWN0S2V5JzsgLy/liJvlu7rkuIDkuKrlrrnlmajvvIzov5Tlm57kuIDkuKpzdG9yZQoKdmFyIFN0b3JlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBTdG9yZShvcHRpb25zKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdG9yZSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJjb21taXQiLCBmdW5jdGlvbiAodHlwZSwgcGF5bG9hZCkgewogICAgICAvL+WPquiDvei/meS5iOWGme+8iOacrOi0qOaYr+mAmui/h2JpbmTov5vooYzkuobovazkuYnvvIkKICAgICAgX3RoaXMuX211dGF0aW9uc1t0eXBlXShwYXlsb2FkKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZGlzcGF0Y2giLCBmdW5jdGlvbiAodHlwZSwgcGF5bG9hZCkgewogICAgICBfdGhpcy5fYWN0aW9uc1t0eXBlXShwYXlsb2FkKTsKICAgIH0pOwoKICAgIC8vVnVleDMg5YaF6YOo5Lya5Yib6YCg5LiA5LiqdnVl5a6e5L6L77yM5L2G5pivIFZ1ZXg0IOebtOaOpemHh+eUqCB2dWUzIOaPkOS+m+eahOWTjeW6lOW8j+aWueazlQogICAgdmFyIHN0b3JlID0gdGhpczsKICAgIHN0b3JlLl9zdGF0ZSA9IHJlYWN0aXZlKHsKICAgICAgZGF0YTogb3B0aW9ucy5zdGF0ZQogICAgfSk7IC8vcmVhY3RpdmXmmK/kuLrkuoblkI7pnaLmmK/phY1yZXBsYWNlU3RhdGUKCiAgICB2YXIgZ2V0dGVycyA9IG9wdGlvbnMuZ2V0dGVyczsgLy97ZG91YmxlOmZ1bmN0aW9uID0+IGdldHRlcn0g5omA5LulZ2V0dGVy5a2Y5Zyo5ZyoT2JqZWN0LmRlZmluZVByb3BlcnR5CgogICAgc3RvcmUuX2dldHRlcnMgPSB7fTsKICAgIGZvckVhY2hWYWx1ZShnZXR0ZXJzLCBmdW5jdGlvbiAoZm4sIGtleSkgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc3RvcmUuX2dldHRlcnMsIGtleSwgewogICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgcmV0dXJuIGZuKHN0b3JlLnN0YXRlKTsKICAgICAgICB9IC8vY29tcHV0ZWTlm6DkuLrnu4Tku7bplIDmr4HkvJrooqvnp7vpmaTvvIzmiYDku6XkuI3og73kvb/nlKgo6L+Z56eN5YaZ5rOV5a2Y5Zyo5oCn6IO96Zeu6aKY77yM5YC85rKh5pS55Y+YCgogICAgICB9KTsKICAgIH0pOyAvL211dGF0aW9uIGFjdGlvbiB7YWRkOmZ1bmN0aW9ufSAge2FzeW5jQWRkOmZ1bmN0aW9ufQogICAgLy9jb21taXQoJ2FkZCcpIGRpc3BhdGNoKCdhc3luY0FkZCcpICAgIOaJgOS7pe+8muacrOi0qOWwseaYr+WPkeW4g+iuoumYheiAheaooeW8jwoKICAgIHN0b3JlLl9tdXRhdGlvbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgc3RvcmUuX2FjdGlvbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdmFyIG11dGF0aW9ucyA9IG9wdGlvbnMubXV0YXRpb25zOwogICAgdmFyIGFjdGlvbnMgPSBvcHRpb25zLmFjdGlvbnM7CiAgICBmb3JFYWNoVmFsdWUobXV0YXRpb25zLCBmdW5jdGlvbiAobXV0YXRpb24sIGtleSkgewogICAgICBzdG9yZS5fbXV0YXRpb25zW2tleV0gPSBmdW5jdGlvbiAocGF5bG9hZCkgewogICAgICAgIG11dGF0aW9uLmNhbGwoc3RvcmUsIHN0b3JlLnN0YXRlLCBwYXlsb2FkKTsKICAgICAgfTsKICAgIH0pOwogICAgZm9yRWFjaFZhbHVlKGFjdGlvbnMsIGZ1bmN0aW9uIChhY3Rpb24sIGtleSkgewogICAgICBzdG9yZS5fYWN0aW9uc1trZXldID0gZnVuY3Rpb24gKHBheWxvYWQpIHsKICAgICAgICBhY3Rpb24uY2FsbChzdG9yZSwgc3RvcmUsIHBheWxvYWQpOwogICAgICB9OwogICAgfSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU3RvcmUsIFt7CiAgICBrZXk6ICJzdGF0ZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlLmRhdGE7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW5zdGFsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbChhcHAsIGluamVjdEtleSkgewogICAgICAvL2NyZWF0ZUFwcCgpLnVzZShzdG9yZSwnbWUnKQogICAgICAvL+WFqOWxgOaatOmcsuS4gOS4quWPmOmHj++8jOaatOmcsueahOaYr3N0b3Jl55qE5a6e5L6LCiAgICAgIGFwcC5wcm92aWRlKGluamVjdEtleSB8fCBzdG9yZUtleSwgdGhpcyk7IC8v57uZ5qC5YXBw5aKe5Yqg5LiA5LiqcHJvdmlkZXMs5a2Q57uE5Lu25Lya5Y675ZCR5LiK5p+l5om+CgogICAgICBhcHAuY29uZmlnLmdsb2JhbFByb3BlcnRpZXMuJHN0b3JlID0gdGhpczsgLy/lop7mt7skc3RvcmXlsZ7mgKcoJHN0b3JlLnN0YXRlLi4uLi4pCiAgICB9CiAgfV0pOwoKICByZXR1cm4gU3RvcmU7Cn0oKTsKCmV4cG9ydCB7IFN0b3JlIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["/Users/maxinyu/Desktop/Vuex-SourceCode/src/vuex/store.js"],"names":["reactive","forEachValue","storeKey","Store","options","type","payload","_mutations","_actions","store","_state","data","state","getters","_getters","fn","key","Object","defineProperty","get","create","mutations","actions","mutation","call","action","app","injectKey","provide","config","globalProperties","$store"],"mappings":";;;;;AAAA,SAASA,QAAT,QAAyB,KAAzB;AACA,SAASC,YAAT,QAA6B,SAA7B;AACA,SAASC,QAAT,QAAyB,aAAzB,C,CAEA;;IACqBC,K;AACjB,iBAAYC,OAAZ,EAAqB;AAAA;;AAAA;;AAAA,oCA+BZ,UAACC,IAAD,EAAOC,OAAP,EAAmB;AAAE;AAC1B,MAAA,KAAI,CAACC,UAAL,CAAgBF,IAAhB,EAAsBC,OAAtB;AACH,KAjCoB;;AAAA,sCAkCV,UAACD,IAAD,EAAOC,OAAP,EAAmB;AAC1B,MAAA,KAAI,CAACE,QAAL,CAAcH,IAAd,EAAoBC,OAApB;AACH,KApCoB;;AACjB;AACA,QAAMG,KAAK,GAAG,IAAd;AACAA,IAAAA,KAAK,CAACC,MAAN,GAAeV,QAAQ,CAAC;AAAEW,MAAAA,IAAI,EAAEP,OAAO,CAACQ;AAAhB,KAAD,CAAvB,CAHiB,CAGgC;;AAEjD,QAAMC,OAAO,GAAGT,OAAO,CAACS,OAAxB,CALiB,CAKgB;;AAEjCJ,IAAAA,KAAK,CAACK,QAAN,GAAiB,EAAjB;AAEAb,IAAAA,YAAY,CAACY,OAAD,EAAU,UAASE,EAAT,EAAaC,GAAb,EAAkB;AAChCC,MAAAA,MAAM,CAACC,cAAP,CAAsBT,KAAK,CAACK,QAA5B,EAAsCE,GAAtC,EAA2C;AACvCG,QAAAA,GAAG,EAAE;AAAA,iBAAMJ,EAAE,CAACN,KAAK,CAACG,KAAP,CAAR;AAAA,SADkC,CACZ;;AADY,OAA3C;AAGH,KAJO,CAAZ,CATiB,CAcb;AACA;;AACJH,IAAAA,KAAK,CAACF,UAAN,GAAmBU,MAAM,CAACG,MAAP,CAAc,IAAd,CAAnB;AACAX,IAAAA,KAAK,CAACD,QAAN,GAAiBS,MAAM,CAACG,MAAP,CAAc,IAAd,CAAjB;AACA,QAAMC,SAAS,GAAGjB,OAAO,CAACiB,SAA1B;AACA,QAAMC,OAAO,GAAGlB,OAAO,CAACkB,OAAxB;AACArB,IAAAA,YAAY,CAACoB,SAAD,EAAY,UAACE,QAAD,EAAWP,GAAX,EAAmB;AACvCP,MAAAA,KAAK,CAACF,UAAN,CAAiBS,GAAjB,IAAwB,UAACV,OAAD,EAAa;AACjCiB,QAAAA,QAAQ,CAACC,IAAT,CAAcf,KAAd,EAAqBA,KAAK,CAACG,KAA3B,EAAkCN,OAAlC;AACH,OAFD;AAGH,KAJW,CAAZ;AAKAL,IAAAA,YAAY,CAACqB,OAAD,EAAU,UAACG,MAAD,EAAST,GAAT,EAAiB;AACnCP,MAAAA,KAAK,CAACD,QAAN,CAAeQ,GAAf,IAAsB,UAACV,OAAD,EAAa;AAC/BmB,QAAAA,MAAM,CAACD,IAAP,CAAYf,KAAZ,EAAmBA,KAAnB,EAA0BH,OAA1B;AACH,OAFD;AAGH,KAJW,CAAZ;AAKH;;;;SAQD,eAAY;AACR,aAAO,KAAKI,MAAL,CAAYC,IAAnB;AACH;;;WACD,iBAAQe,GAAR,EAAaC,SAAb,EAAwB;AAAE;AACtB;AACAD,MAAAA,GAAG,CAACE,OAAJ,CAAYD,SAAS,IAAIzB,QAAzB,EAAmC,IAAnC,EAFoB,CAEsB;;AAC1CwB,MAAAA,GAAG,CAACG,MAAJ,CAAWC,gBAAX,CAA4BC,MAA5B,GAAqC,IAArC,CAHoB,CAGuB;AAC9C;;;;;;SA9CgB5B,K","sourcesContent":["import { reactive } from 'vue'\nimport { forEachValue } from './utils'\nimport { storeKey } from './injectKey'\n\n//创建一个容器，返回一个store\nexport default class Store {\n    constructor(options) {\n        //Vuex3 内部会创造一个vue实例，但是 Vuex4 直接采用 vue3 提供的响应式方法\n        const store = this;\n        store._state = reactive({ data: options.state }) //reactive是为了后面是配replaceState\n\n        const getters = options.getters; //{double:function => getter} 所以getter存在在Object.defineProperty\n\n        store._getters = {}\n\n        forEachValue(getters, function(fn, key) {\n                Object.defineProperty(store._getters, key, {\n                    get: () => fn(store.state) //computed因为组件销毁会被移除，所以不能使用(这种写法存在性能问题，值没改变\n                })\n            })\n            //mutation action {add:function}  {asyncAdd:function}\n            //commit('add') dispatch('asyncAdd')    所以：本质就是发布订阅者模式\n        store._mutations = Object.create(null);\n        store._actions = Object.create(null);\n        const mutations = options.mutations;\n        const actions = options.actions;\n        forEachValue(mutations, (mutation, key) => {\n            store._mutations[key] = (payload) => {\n                mutation.call(store, store.state, payload)\n            }\n        })\n        forEachValue(actions, (action, key) => {\n            store._actions[key] = (payload) => {\n                action.call(store, store, payload)\n            }\n        })\n    }\n    commit = (type, payload) => { //只能这么写（本质是通过bind进行了转义）\n        this._mutations[type](payload)\n    }\n    dispatch = (type, payload) => {\n        this._actions[type](payload)\n    }\n\n    get state() {\n        return this._state.data;\n    }\n    install(app, injectKey) { //createApp().use(store,'me')\n        //全局暴露一个变量，暴露的是store的实例\n        app.provide(injectKey || storeKey, this); //给根app增加一个provides,子组件会去向上查找\n        app.config.globalProperties.$store = this; //增添$store属性($store.state.....)\n    }\n}"]}]}